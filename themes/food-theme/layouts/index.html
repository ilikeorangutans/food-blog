{{ define "main"}}

{{ .Content }}

<div class="posts">
  <h1 class="content-subhead">Recent Posts</h1>
  {{ range first 5 (.Site.RegularPages.ByDate ).Reverse }}
  <section class="post">
    <header class="post-header">
      <h2 class="post-title">
        {{ if eq .Type "recipes" }}
          Recipe:
        {{ end }}
        <a href="{{ .RelPermalink }}">
          {{ .LinkTitle }}
        </a>
      </h2>

      <p class="post-meta">
        Posted on <em>{{ .PublishDate.Format "January 2, 2006" }}</em>
        {{- if not (eq .Date .Lastmod) }}
          <strong>and last updated on <em>{{ .Lastmod.Format "January 2, 2006" -}}</em></strong>
        {{- end -}}
        {{- if .Params.tags }}, filed under {{ range $tag := .Params.tags }}<a class="post-category" href="/tags/{{ $tag | urlize }}">{{ $tag | title }}</a>{{ end -}}
        {{ end }}
      </p>
    </header>

    <div class="post-description">
      <div class="post-images pure-g">
        {{ $current := . }}
        {{ range first 2 (.Resources.ByType "image") }}
          {{ $image := .Fill "500x375 center" }}
          <div class="pure-u-1 pure-u-md-1-2">
            <a href="{{ $current.RelPermalink }}">
              <img alt="{{ $current.Title }}"
                   class="pure-img-responsive"
                   src="{{ $image.RelPermalink }}">
            </a>
          </div>
        {{ end }}
      </div>
      <p>
        {{ .Summary }}
      </p>
      <a href="{{ .RelPermalink }}">
        Read more
      </a>
    </div>
  </section>
  {{ end }}
  <h1 class="content-subhead">But wait, there's more!</h1>
  {{ with .Site.GetPage "/posts" }}<p><a href="{{ .Permalink }}">&rarr; {{ .Title }}</a></p>{{ end }}
  {{ with .Site.GetPage "/tags" }}<p><a href="{{ .Permalink }}">&rarr; {{ .Title }}</a></p>{{ end }}
  {{ with .Site.GetPage "/recipes" }}<p><a href="{{ .Permalink }}">&rarr; {{ .Title }}</a></p>{{ end }}
</div>
{{ end }}
